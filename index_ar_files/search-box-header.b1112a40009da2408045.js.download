(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{101:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return WidgetInitializer}));var widget_init=__webpack_require__(1),ElementsEnumerator=function(elementsClass){this.elementsClass=elementsClass};ElementsEnumerator.prototype.getElements=function(){for(var elements=document.getElementsByClassName(this.elementsClass),elementIdPrefix=this.elementsClass+"-",i=0;i<elements.length;i++){elements[i].setAttribute("id",elementIdPrefix+(i+1))}return elements};var WidgetInitializer=function(elementsClass){this.elementsClass=elementsClass};function innerInitialization(initializationCallback){for(var notInitializedElements=new ElementsEnumerator(this.elementsClass).getElements(),i=0;i<notInitializedElements.length;i++){var element=notInitializedElements[i];if(element.hasAttribute("data-vue-initialized"))return;var newElement=initializationCallback(element);newElement&&(element=newElement),element.setAttribute("data-vue-initialized","")}}WidgetInitializer.prototype.initialize=function(initializationCallback){var that=this;Object(widget_init.a)((function(){return innerInitialization.call(that,initializationCallback)}))}},149:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _functions_widget_initializer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(101),_functions_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),widgetInitializer=new _functions_widget_initializer__WEBPACK_IMPORTED_MODULE_0__.a(_functions_constants__WEBPACK_IMPORTED_MODULE_1__.a.COMPONENTS.SEARCH_BOX_HEADER);function initHeaderApp(element){return new Vue({el:"#"+element.id,data:{isExpanded:!1},mounted(){this.$el.addEventListener("focusout",this.focusout),this.handleSearch()},beforeDestroy(){this.$el.removeEventListener("focusout",this.focusout)},methods:{toggle(){this.isExpanded=!this.isExpanded},focusout(e){this.$el.contains(e.relatedTarget)||(this.isExpanded=!1)},handleSearch(){for(var searchBoxIdFields=$('[data-sf-role="searchTextBoxId"]'),i=0;i<searchBoxIdFields.length;i++){var searchBoxIdField=$(searchBoxIdFields[i]);featherSearchBoxWidget({resultsUrl:searchBoxIdField.siblings('[data-sf-role="resultsUrl"]').first().val(),indexCatalogue:searchBoxIdField.siblings('[data-sf-role="indexCatalogue"]').first().val(),wordsMode:searchBoxIdField.siblings('[data-sf-role="wordsMode"]').first().val(),disableSuggestions:$.parseJSON(searchBoxIdField.siblings('[data-sf-role="disableSuggestions"]').first().val()),minSuggestionLength:searchBoxIdField.siblings('[data-sf-role="minSuggestionLength"]').first().val(),suggestionFields:searchBoxIdField.siblings('[data-sf-role="suggestionFields"]').first().val(),language:searchBoxIdField.siblings('[data-sf-role="language"]').first().val(),suggestionsRoute:searchBoxIdField.siblings('[data-sf-role="suggestionsRoute"]').first().val(),searchTextBoxSelector:searchBoxIdField.val(),searchButtonSelector:searchBoxIdField.siblings('[data-sf-role="searchButtonId"]').first().val()})}function featherSearchBoxWidget(serverData){var searchTextBox=$(serverData.searchTextBoxSelector);function suggestionsSuccessHandler(result,args){var dataSource=result.Suggestions;null!==dataSource&&dataSource.length>0?function(dataSource){for(var suggestions=searchTextBox.siblings(".search-suggestions"),list=$("<ul />",{class:"suggestions-list"}),i=0;i<dataSource.length;i++)dataSource[i].length>0&&list.append($("<li />",{text:dataSource[i],mousedown:itemMousedown}));suggestions.html(list),suggestions.removeClass("hidden").show()}(dataSource):searchTextBox.siblings(".search-suggestions").addClass("hidden").show()}function navigateToResults(e){e||(e=window.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1;var query=searchTextBox.val();query&&query.trim()&&serverData.indexCatalogue&&(window.DataIntelligenceSubmitScript&&DataIntelligenceSubmitScript._client.sentenceClient.writeSentence({predicate:"Search for",object:searchTextBox.val(),objectMetadata:[{K:"PageUrl",V:location.href}]}),window.location=function(){var query=searchTextBox.val().trim(),catalogueParam=(-1===serverData.resultsUrl.indexOf("?")?"?":"&")+"indexCatalogue="+encodeURIComponent(serverData.indexCatalogue),searchQueryParam="&searchQuery="+encodeURIComponent(query),wordsModeParam="&wordsMode="+serverData.wordsMode;return serverData.resultsUrl+catalogueParam+searchQueryParam+wordsModeParam}())}function itemMousedown(e){searchTextBox.val(e.target.textContent),navigateToResults(e)}$(serverData.searchButtonSelector).click(navigateToResults),searchTextBox.keydown((function(e){e||(e=window.event);var keyCode=null;keyCode=e.keyCode?e.keyCode:e.charCode;switch(keyCode){case 40:!function(targetInput){var suggestionsList=targetInput.parentElement.querySelector("ul.suggestions-list"),selectedItem=suggestionsList.querySelector("li.active"),allListItems=suggestionsList.querySelectorAll("li");if(null===selectedItem&&allListItems.length>0){var firstListItem=suggestionsList.firstChild;firstListItem.classList.add("active"),targetInput.value=firstListItem.innerText}else selectedItem!==suggestionsList.lastChild&&(selectedItem.classList.remove("active"),selectedItem.nextSibling.classList.add("active"),targetInput.value=selectedItem.nextSibling.innerText)}(e.target);break;case 38:targetInput=e.target,suggestionsList=targetInput.parentElement.querySelector("ul.suggestions-list"),null!==(selectedItem=suggestionsList.querySelector("li.active"))&&selectedItem!==suggestionsList.firstChild&&(selectedItem.classList.remove("active"),selectedItem.previousSibling.classList.add("active"),targetInput.value=selectedItem.previousSibling.innerText);break;case 27:$(e.target.parentElement.querySelector("div.search-suggestions")).hide();break;case 13:navigateToResults(e)}var targetInput,suggestionsList,selectedItem})),serverData.disableSuggestions||(searchTextBox.keyup((function(e){if(38!==e.keyCode&&40!==e.keyCode&&27!==e.keyCode){13===e.keyCode&&navigateToResults(e);var request={},searchText=searchTextBox.val().trim();searchText.length>=serverData.minSuggestionLength&&(request.IndexName=serverData.indexCatalogue,request.SuggestionFields=serverData.suggestionFields,request.Text=searchText,request.Language=serverData.language,$.ajax({type:"GET",url:serverData.suggestionsRoute,dataType:"json",data:request,success:suggestionsSuccessHandler}))}})),searchTextBox.blur((function(e){$(e.target.parentElement.querySelector("div.search-suggestions")).hide()})))}}}}).$el}GlobalApp.registerInitializationHandler(_functions_constants__WEBPACK_IMPORTED_MODULE_1__.a.COMPONENTS.SEARCH_BOX_HEADER,(function(){widgetInitializer.initialize(initHeaderApp)}))}}]);
//# sourceMappingURL=search-box-header.b1112a40009da2408045.js.map